
\usepackage[toc]{appendix}
\usepackage{scrextend}
\usepackage{gregoriotex}
\usepackage{libertine}

%\usepackage[none]{hyphenat}
\usepackage{indentfirst}
\usepackage{ragged2e}
\usepackage[center]{titlesec}
\usepackage{tabularx}
\usepackage{array}
\usepackage{tabu}
\usepackage{fancyhdr}
\usepackage{pdfpages}
\usepackage{environ}
\usepackage{setspace}
\usepackage{needspace}
\usepackage{xcolor}
\usepackage{pifont} % used for dingbat
\usepackage{paracol}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\titleformat{\paragraph}
  {\centering\normalfont\bfseries} % format
  {}% label
  {0pt} % sep
  {\large}

\titlespacing*{\chapter}{0pt}{-0pt}{40pt}


\newcommand{\newpageheader}[2]{\fancypagestyle{#2}{%
	\fancyhead{}
	\fancyhead[CE]{#1}
	\fancyhead[CO]{#2}
	\fancyhead[LE,RO]{\thepage}
	\fancyfoot{}}
    \pagestyle{#2}
}

\renewcommand\thechapter{\Alph{chapter}}
\renewcommand\thesection{\arabic{section}}

\newcommand*{\red}[1]{#1}
\newcommand*{\redit}[1]{\textit{#1}}

\newcommand*{\rubric}[1]{\textit{#1}}
\newcommand*{\cross}[1]{\textbf{#1}}

\newcommand*{\instruction}[1]{\begin{addmargin}[\parindent]{0em}\textit{\small #1}\end{addmargin}}
\newcommand*{\titlerubric}[1]{\needspace{3\baselineskip}\smallbreak\noindent#1}
% \enlargethispage is a horrible hack to make sure there is always space for this
\newcommand*{\reference}[1]{\enlargethispage{\baselineskip}\nopagebreak\hfill{\textit{#1}}}

\newcommand*{\hrline}{\par {\centering\noindent\rule{\textwidth/2}{0.4pt}\par}}
\newcommand*{\hrlinered}{\hrline}

\usepackage{changepage}
\usepackage{etoolbox}
\AtBeginEnvironment{adjustwidth}{\partopsep\parskip}

\newcommand{\prayer}[3][3em]{%
  \nopagebreak%
  \begin{adjustwidth}{#1}{0pt}%
    \makebox[0pt][r]{\makebox[#1][l]{\redit{#2}}}%
    \ignorespaces #3
  \end{adjustwidth}%
  \nopagebreak%
}

\newcommand\responce[1]{%
  \unskip\hfill\penalty100\relax\hspace*{0.5em}\hspace*{\fill}\mbox{\textbf{#1}}%
}

\usepackage{enumitem}

\setlist[itemize]{noitemsep, topsep=0pt}

\makeatletter
\newenvironment{litany}
  {\list{\topsep=0pt}{%
   \setlength{\topsep}{0pt}%
   \setlength{\partopsep}{0pt}%
   \setlength{\leftmargin}{2em}%
   \setlength{\listparindent}{-2em}%
   \setlength{\itemindent}{-2em}%
   \setlength{\parsep}{\parskip}}%
   \item[]}%
  {\endlist}
\makeatother

\makeatletter
\newenvironment{psalm}
  {\list{\topsep=0pt}{%
   \setlength{\topsep}{-1em}%
   \setlength{\partopsep}{0pt}%
   \setlength{\leftmargin}{3.5em}%
   \setlength{\listparindent}{-2em}%
   \setlength{\itemindent}{-2em}%
   \setlength{\parsep}{\parskip}}%
   \item[]}%
  {\endlist}
\makeatother

\usepackage{xpatch}
\makeatletter
\newlength{\abovefirstappchapskip}
\newlength{\belowfirstappchapskip}
\AtBeginEnvironment{appendices}{%
  \xpatchcmd{\@makechapterhead}{%
    \vspace*{50\p@}%
  }{%
    \ifnum1=\c@chapter
    \vskip\abovefirstappchapskip%
    \fi
  }{}{}
  \xpatchcmd{\@makechapterhead}{%
    \parindent \z@ \raggedright \normalfont
  }{%
    \parindent \z@ \raggedright \normalfont
    \ifnum1=\c@chapter
    \begingroup 
    \centering \Huge\bfseries \appendixname
    \vskip\belowfirstappchapskip
    \endgroup
    \fi
  }{}{}
}
\makeatother

\setlength{\abovefirstappchapskip}{30pt}
\setlength{\belowfirstappchapskip}{30pt}
